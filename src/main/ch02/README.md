# 2. 리팩터링 원칙

## 2.1 리팩터링

----
소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이행하고 수정하기 쉽도록 내부 구조를 변경하는 기법

 
1. 리팩터링하기 전과 후의 코드가 똑같이 동작해야 한다.

2. 리팩터링 과정에서 발견된 버그는 리팩터링 후에도 그대로 남아 있어야 한다.

## 2.2 두 개의 모자

----
> '기능 추가' 모자 & '리팩터링' 모자
 
1. 기능을 추가할 때는 기존 코드를 건드리지 않고 새 기능을 추가
2. 리팩터링을 할 때는 기능 추가를 하지 않고 코드 재구성

전체 작업 시간이 10분 정도로 짧다 해도, 항상 내가 쓰고 있는 모자가 무엇인지와 그에 따른 작업 방식의 차이를 분명하게 인식

## 2.3 리팩터링하는 이유

----
리팩터링이 소프트웨어의 모든 문제점을 해결하는 만병통치약은 아니지만 코드를 건강한 상태로 유지하는 데 도와주는 약이다.

1. 소프트웨어 설계가 좋아진다

아키텍처를 충분히 이해하지 못한 채 단기 목표만을 위해 코드를 수정하다 보면 기반 구조가 무너지기 쉽다. 코드만으로 설계를 파악하기 어려워질수록 설계를 유지하기 어려워지고, 부폐가 가속화된다. 규칙적인 리팩터링은 코드의 구조를 지탱해줄 것이다.

코드가 길면 실수 없이 수정하기 어려워지고 이해해야 할 코드량도 늘어난다. 비슷한 일을 하는 코드가 산재해 있다면 코드를 수정했을 때 예상대로 작동하지 않을 수 있다. 리팩터링을 통해 반복되는 중복 코드를 제거하면 모든 코드가 언제나 고유한 일을 수행함을 보장할 수 있다.

2. 소프트웨어를 이해하기 쉬워진다

프로그램을 동작시키는 데만 신경 쓰는 것은 나중에 그 코드를 다룰 개발자에 대한 배려가 없는 것이다. 리팩터링은 코드가 더 잘 읽히게 도와준다.


3. 리팩터링하면 버그를 쉽게 찾을 수 있다

코드를 이해하기 쉽다는 말은 버그를 찾기 쉽다는 말이기도 하다. 리팩터링하면 코드가 하는 일을 깊이 파악할 수 있어서 깨달은 것을 코드에 금방 반영할 수 있다.


4. 리팩터링하면 프로그래밍 속도를 높일 수 있다

얼핏 반대가 아닌가라고 생각할 수 있지만, 리팩터링하면 코드 개발 속도를 높일 수 있다.

내부 설계가 잘 된 소프트웨어는 새로운 기능을 추가할 지점과 고치는 방법을 쉽게 찾을 수 있다. 모듈화가 잘 되어 있으면 전체 코드베이스 중 작은 일부만 이해하면 된다. 코드가 명확하면 버그를 만들 가능성도 줄고, 버그를 만들더라도 디버깅하기가 쉬워집니다. 내부 품질이 뛰어난 코드베이스는 새 기능 구축을 돕는 견고한 토대가 된다.

> 마틴 파울러는 이 효과를 설계 지구력 가설 (Design Stamina Hypothesis) 라고 부른다. 이는 내부 설계에 심혈을 기울이면 소프트웨어의 지구력이 높아져서 빠르게 개발할 수 있는 상태를 더 오래 지속할 수 있다.

## 2.4 언제 리팩터링해야 할까?

----

### 3의 법칙
1. 그냥 한다.
2. 비슷한 일을 두 번해도 일단 계속 한다.
3. 비슷한 일을 세 번하면 리팩터링한다.
